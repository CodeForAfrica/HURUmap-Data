SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET client_min_messages = warning;

ALTER TABLE IF EXISTS ONLY public.tobacco_use DROP CONSTRAINT IF EXISTS pk_tobacco_use;
DROP TABLE IF EXISTS public.tobacco_use;
SET default_tablespace = '';

SET default_with_oids = false;

CREATE TABLE IF NOT EXISTS public.tobacco_use (
	geo_level TEXT,
	geo_code TEXT,
	geo_version NUMERIC,
	parent_level TEXT,
	parent_code TEXT,
	variable TEXT,
	value NUMERIC,
	name TEXT
);

ALTER TABLE ONLY public.tobacco_use ADD CONSTRAINT pk_tobacco_use PRIMARY KEY (geo_level, geo_code, geo_version, parent_level, parent_code, variable, value, name);

INSERT INTO public.tobacco_use VALUES
('level2','ZA_2_00244',2009,'level1','ZA_1_002','Not smoking',88,'Alfred Nzo'),
('level2','ZA_2_00244',2009,'level1','ZA_1_002','Smoking',12,'Alfred Nzo'),
('level2','ZA_2_00525',2009,'level1','ZA_1_005','Not smoking',83,'Amajuba'),
('level2','ZA_2_00525',2009,'level1','ZA_1_005','Smoking',17,'Amajuba'),
('level2','ZA_2_00212',2009,'level1','ZA_1_002','Not smoking',86,'Amathole'),
('level2','ZA_2_00212',2009,'level1','ZA_1_002','Smoking',14,'Amathole'),
('level2','ZA_2_00637',2009,'level1','ZA_1_006','Not smoking',81,'Bojanala'),
('level2','ZA_2_00637',2009,'level1','ZA_1_006','Smoking',19,'Bojanala'),
('level2','ZA_2_00292',2009,'level1','ZA_1_002','Not smoking',78,'Buffalo City'),
('level2','ZA_2_00292',2009,'level1','ZA_1_002','Smoking',22,'Buffalo City'),
('level2','ZA_2_00213',2009,'level1','ZA_1_002','Not smoking',83,'Chris Hani'),
('level2','ZA_2_00213',2009,'level1','ZA_1_002','Smoking',17,'Chris Hani'),
('level2','ZA_2_00191',2009,'level1','ZA_1_001','Not smoking',71,'City of Cape Town'),
('level2','ZA_2_00191',2009,'level1','ZA_1_001','Smoking',29,'City of Cape Town'),
('level2','ZA_2_00102',2009,'level1','ZA_1_001','Not smoking',69,'Cape Winelands'),
('level2','ZA_2_00102',2009,'level1','ZA_1_001','Smoking',31,'Cape Winelands'),
('level2','ZA_2_00935',2009,'level1','ZA_1_009','Not smoking',86,'Capricorn'),
('level2','ZA_2_00935',2009,'level1','ZA_1_009','Smoking',14,'Capricorn'),
('level2','ZA_2_00105',2009,'level1','ZA_1_001','Not smoking',53,'Central Karoo'),
('level2','ZA_2_00105',2009,'level1','ZA_1_001','Smoking',47,'Central Karoo'),
('level2','ZA_2_00797',2009,'level1','ZA_1_007','Not smoking',80,'Ekurhuleni'),
('level2','ZA_2_00797',2009,'level1','ZA_1_007','Smoking',20,'Ekurhuleni'),
('level2','ZA_2_00640',2009,'level1','ZA_1_006','Not smoking',79,'Dr Kenneth Kaunda'),
('level2','ZA_2_00640',2009,'level1','ZA_1_006','Smoking',21,'Dr Kenneth Kaunda'),
('level1','ZA_1_002',2009,'country','ZA','Not smoking',83,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Smoking',17,'Eastern Cape'),
('level2','ZA_2_00832',2009,'level1','ZA_1_008','Not smoking',90,'Ehlanzeni'),
('level2','ZA_2_00832',2009,'level1','ZA_1_008','Smoking',10,'Ehlanzeni'),
('level2','ZA_2_00420',2009,'level1','ZA_1_004','Not smoking',80,'Fezile Dabi'),
('level2','ZA_2_00420',2009,'level1','ZA_1_004','Smoking',20,'Fezile Dabi'),
('level2','ZA_2_00309',2009,'level1','ZA_1_003','Not smoking',74,'Frances Baard'),
('level2','ZA_2_00309',2009,'level1','ZA_1_003','Smoking',26,'Frances Baard'),
('level1','ZA_1_004',2009,'country','ZA','Not smoking',80,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Smoking',20,'Free State'),
('level2','ZA_2_00830',2009,'level1','ZA_1_008','Not smoking',78,'Gert Sibande'),
('level2','ZA_2_00830',2009,'level1','ZA_1_008','Smoking',22,'Gert Sibande'),
('level2','ZA_2_00104',2009,'level1','ZA_1_001','Not smoking',69,'Garden Route'),
('level2','ZA_2_00104',2009,'level1','ZA_1_001','Smoking',31,'Garden Route'),
('level1','ZA_1_007',2009,'country','ZA','Not smoking',79,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Smoking',21,'Gauteng'),
('level2','ZA_2_00543',2009,'level1','ZA_1_005','Not smoking',88,'Harry Gwala'),
('level2','ZA_2_00543',2009,'level1','ZA_1_005','Smoking',12,'Harry Gwala'),
('level2','ZA_2_00345',2009,'level1','ZA_1_003','Not smoking',76,'John Taolo Gaetsewe'),
('level2','ZA_2_00345',2009,'level1','ZA_1_003','Smoking',24,'John Taolo Gaetsewe'),
('level2','ZA_2_00214',2009,'level1','ZA_1_002','Not smoking',83,'Joe Gqabi'),
('level2','ZA_2_00214',2009,'level1','ZA_1_002','Smoking',17,'Joe Gqabi'),
('level2','ZA_2_00798',2009,'level1','ZA_1_007','Not smoking',77,'City of Johannesburg'),
('level2','ZA_2_00798',2009,'level1','ZA_1_007','Smoking',23,'City of Johannesburg'),
('level2','ZA_2_00528',2009,'level1','ZA_1_005','Not smoking',94,'King Cetshwayo'),
('level2','ZA_2_00528',2009,'level1','ZA_1_005','Smoking',6,'King Cetshwayo'),
('level1','ZA_1_005',2009,'country','ZA','Not smoking',87,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Smoking',13,'KwaZulu-Natal'),
('level2','ZA_2_00418',2009,'level1','ZA_1_004','Not smoking',80,'Lejweleputswa'),
('level2','ZA_2_00418',2009,'level1','ZA_1_004','Smoking',20,'Lejweleputswa'),
('level1','ZA_1_009',2009,'country','ZA','Not smoking',88,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Smoking',12,'Limpopo'),
('level2','ZA_2_00494',2009,'level1','ZA_1_004','Not smoking',79,'Mangaung'),
('level2','ZA_2_00494',2009,'level1','ZA_1_004','Smoking',21,'Mangaung'),
('level2','ZA_2_00933',2009,'level1','ZA_1_009','Not smoking',89,'Mopani'),
('level2','ZA_2_00933',2009,'level1','ZA_1_009','Smoking',11,'Mopani'),
('level1','ZA_1_008',2009,'country','ZA','Not smoking',82,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Smoking',18,'Mpumalanga'),
('level2','ZA_2_00638',2009,'level1','ZA_1_006','Not smoking',86,'Ngaka Modiri Molema'),
('level2','ZA_2_00638',2009,'level1','ZA_1_006','Smoking',14,'Ngaka Modiri Molema'),
('level2','ZA_2_00306',2009,'level1','ZA_1_003','Not smoking',44,'Namakwa'),
('level2','ZA_2_00306',2009,'level1','ZA_1_003','Smoking',56,'Namakwa'),
('level2','ZA_2_00293',2009,'level1','ZA_1_002','Not smoking',80,'Nelson Mandela Bay'),
('level2','ZA_2_00293',2009,'level1','ZA_1_002','Smoking',20,'Nelson Mandela Bay'),
('level2','ZA_2_00831',2009,'level1','ZA_1_008','Not smoking',77,'Nkangala'),
('level2','ZA_2_00831',2009,'level1','ZA_1_008','Smoking',23,'Nkangala'),
('level1','ZA_1_006',2009,'country','ZA','Not smoking',80,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Smoking',20,'North West'),
('level1','ZA_1_003',2009,'country','ZA','Not smoking',67,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Smoking',33,'Northern Cape'),
('level2','ZA_2_00215',2009,'level1','ZA_1_002','Not smoking',89,'O.R.Tambo'),
('level2','ZA_2_00215',2009,'level1','ZA_1_002','Smoking',11,'O.R.Tambo'),
('level2','ZA_2_00103',2009,'level1','ZA_1_001','Not smoking',66,'Overberg'),
('level2','ZA_2_00103',2009,'level1','ZA_1_001','Smoking',34,'Overberg'),
('level2','ZA_2_00307',2009,'level1','ZA_1_003','Not smoking',71,'Pixley ka Seme'),
('level2','ZA_2_00307',2009,'level1','ZA_1_003','Smoking',29,'Pixley ka Seme'),
('level2','ZA_2_00639',2009,'level1','ZA_1_006','Not smoking',71,'Dr Ruth Segomotsi Mompati'),
('level2','ZA_2_00639',2009,'level1','ZA_1_006','Smoking',29,'Dr Ruth Segomotsi Mompati'),
('level2','ZA_2_00210',2009,'level1','ZA_1_002','Not smoking',63,'Sarah Baartman'),
('level2','ZA_2_00210',2009,'level1','ZA_1_002','Smoking',37,'Sarah Baartman'),
('level2','ZA_2_00742',2009,'level1','ZA_1_007','Not smoking',74,'Sedibeng'),
('level2','ZA_2_00742',2009,'level1','ZA_1_007','Smoking',26,'Sedibeng'),
('level2','ZA_2_00947',2009,'level1','ZA_1_009','Not smoking',92,'Sekhukhune'),
('level2','ZA_2_00947',2009,'level1','ZA_1_009','Smoking',8,'Sekhukhune'),
('country','ZA',2009,'continent','AFR','Not smoking',81,'South Africa'),
('country','ZA',2009,'continent','AFR','Smoking',19,'South Africa'),
('level2','ZA_2_00419',2009,'level1','ZA_1_004','Not smoking',82,'Thabo Mofutsanyane'),
('level2','ZA_2_00419',2009,'level1','ZA_1_004','Smoking',18,'Thabo Mofutsanyane'),
('level2','ZA_2_00799',2009,'level1','ZA_1_007','Not smoking',85,'City of Tshwane'),
('level2','ZA_2_00799',2009,'level1','ZA_1_007','Smoking',15,'City of Tshwane'),
('level2','ZA_2_00521',2009,'level1','ZA_1_005','Not smoking',81,'Ugu'),
('level2','ZA_2_00521',2009,'level1','ZA_1_005','Smoking',19,'Ugu'),
('level2','ZA_2_00934',2009,'level1','ZA_1_009','Not smoking',87,'Vhembe'),
('level2','ZA_2_00934',2009,'level1','ZA_1_009','Smoking',13,'Vhembe'),
('level2','ZA_2_00936',2009,'level1','ZA_1_009','Not smoking',86,'Waterberg'),
('level2','ZA_2_00936',2009,'level1','ZA_1_009','Smoking',14,'Waterberg'),
('level2','ZA_2_00101',2009,'level1','ZA_1_001','Not smoking',57,'West Coast'),
('level2','ZA_2_00101',2009,'level1','ZA_1_001','Smoking',43,'West Coast'),
('level2','ZA_2_00748',2009,'level1','ZA_1_007','Not smoking',73,'West Rand'),
('level2','ZA_2_00748',2009,'level1','ZA_1_007','Smoking',27,'West Rand'),
('level1','ZA_1_001',2009,'country','ZA','Not smoking',69,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Smoking',31,'Western Cape'),
('level2','ZA_2_00416',2009,'level1','ZA_1_004','Not smoking',79,'Xhariep'),
('level2','ZA_2_00416',2009,'level1','ZA_1_004','Smoking',21,'Xhariep'),
('level2','ZA_2_00308',2009,'level1','ZA_1_003','Not smoking',61,'Z F Mgcawu'),
('level2','ZA_2_00308',2009,'level1','ZA_1_003','Smoking',39,'Z F Mgcawu'),
('level2','ZA_2_00526',2009,'level1','ZA_1_005','Not smoking',95,'Zululand'),
('level2','ZA_2_00526',2009,'level1','ZA_1_005','Smoking',5,'Zululand'),
('level2','ZA_2_00595',2009,'level1','ZA_1_005','Not smoking',87,'eThekwini'),
('level2','ZA_2_00595',2009,'level1','ZA_1_005','Smoking',13,'eThekwini'),
('level2','ZA_2_00529',2009,'level1','ZA_1_005','Not smoking',86,'iLembe'),
('level2','ZA_2_00529',2009,'level1','ZA_1_005','Smoking',14,'iLembe'),
('level2','ZA_2_00522',2009,'level1','ZA_1_005','Not smoking',83,'Umgungundlovu'),
('level2','ZA_2_00522',2009,'level1','ZA_1_005','Smoking',17,'Umgungundlovu'),
('level2','ZA_2_00527',2009,'level1','ZA_1_005','Not smoking',97,'Umkhanyakude'),
('level2','ZA_2_00527',2009,'level1','ZA_1_005','Smoking',3,'Umkhanyakude'),
('level2','ZA_2_00524',2009,'level1','ZA_1_005','Not smoking',92,'Umzinyathi'),
('level2','ZA_2_00524',2009,'level1','ZA_1_005','Smoking',8,'Umzinyathi'),
('level2','ZA_2_00523',2009,'level1','ZA_1_005','Not smoking',86,'Uthukela'),
('level2','ZA_2_00523',2009,'level1','ZA_1_005','Smoking',14,'Uthukela') ON CONFLICT DO NOTHING;
      
INSERT INTO public.sources(geo_level, country_code, table_name, source_title, source_link) VALUES('level1','ZA','allTobaccoUses','"District Health Barometer, 2018/19"','https://open.africa/dataset/district-health-barometer-2018-19/resource/0fc4804c-6cf8-43ff-aeed-685816c49c25') ON CONFLICT DO NOTHING;
INSERT INTO public.sources(geo_level, country_code, table_name, source_title, source_link) VALUES('country','ZA','allTobaccoUses','"District Health Barometer, 2018/19"','https://open.africa/dataset/district-health-barometer-2018-19/resource/0fc4804c-6cf8-43ff-aeed-685816c49c25') ON CONFLICT DO NOTHING;
