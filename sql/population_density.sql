SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET client_min_messages = warning;

ALTER TABLE IF EXISTS ONLY public.population_density DROP CONSTRAINT IF EXISTS pk_population_density;
DROP TABLE IF EXISTS public.population_density;
SET default_tablespace = '';

SET default_with_oids = false;

CREATE TABLE IF NOT EXISTS public.population_density (
	geo_level TEXT,
	geo_code TEXT,
	geo_version NUMERIC,
	parent_level TEXT,
	parent_code TEXT,
	variable NUMERIC,
	value NUMERIC,
	name TEXT
);

ALTER TABLE ONLY public.population_density ADD CONSTRAINT pk_population_density PRIMARY KEY (geo_level, geo_code, geo_version, parent_level, parent_code, variable, value, name);

INSERT INTO public.population_density VALUES
('level2','ZA_2_00244',2009,'level1','ZA_1_002',2011,74.2,'Alfred Nzo'),
('level2','ZA_2_00525',2009,'level1','ZA_1_005',2011,71.9,'Amajuba'),
('level2','ZA_2_00212',2009,'level1','ZA_1_002',2011,39.4,'Amathole'),
('level2','ZA_2_00637',2009,'level1','ZA_1_006',2011,81.5,'Bojanala'),
('level2','ZA_2_00292',2009,'level1','ZA_1_002',2011,308,'Buffalo City'),
('level2','ZA_2_00102',2009,'level1','ZA_1_001',2011,36.5,'Cape Winelands'),
('level2','ZA_2_00935',2009,'level1','ZA_1_009',2011,57.6,'Capricorn'),
('level2','ZA_2_00105',2009,'level1','ZA_1_001',2011,1.8,'Central Karoo'),
('level2','ZA_2_00213',2009,'level1','ZA_1_002',2011,22.2,'Chris Hani'),
('level2','ZA_2_00191',2009,'level1','ZA_1_001',2011,1532.9,'City of Cape Town'),
('level2','ZA_2_00798',2009,'level1','ZA_1_007',2011,2696,'City of Johannesburg'),
('level2','ZA_2_00799',2009,'level1','ZA_1_007',2011,463.9,'City of Tshwane'),
('level2','ZA_2_00640',2009,'level1','ZA_1_006',2011,47.2,'Dr Kenneth Kaunda'),
('level2','ZA_2_00639',2009,'level1','ZA_1_006',2011,10.5,'Dr Ruth Segomotsi Mompati'),
('level1','ZA_1_002',2009,'country','ZA',2011,38.8,'Eastern Cape'),
('level2','ZA_2_00104',2009,'level1','ZA_1_001',2011,24.5,'Garden Route'),
('level2','ZA_2_00832',2009,'level1','ZA_1_008',2011,60,'Ehlanzeni'),
('level2','ZA_2_00797',2009,'level1','ZA_1_007',2011,1609.1,'Ekurhuleni'),
('level2','ZA_2_00595',2009,'level1','ZA_1_005',2011,1517.3,'eThekwini'),
('level2','ZA_2_00420',2009,'level1','ZA_1_004',2011,23.4,'Fezile Dabi'),
('level2','ZA_2_00309',2009,'level1','ZA_1_003',2011,29.5,'Frances Baard'),
('level1','ZA_1_004',2009,'country','ZA',2011,21.1,'Free State'),
('level1','ZA_1_007',2009,'country','ZA',2011,674.9,'Gauteng'),
('level2','ZA_2_00830',2009,'level1','ZA_1_008',2011,32.5,'Gert Sibande'),
('level2','ZA_2_00529',2009,'level1','ZA_1_005',2011,184.3,'iLembe'),
('level2','ZA_2_00214',2009,'level1','ZA_1_002',2011,13.5,'Joe Gqabi'),
('level2','ZA_2_00345',2009,'level1','ZA_1_003',2011,8.2,'John Taolo Gaetsewe'),
('level1','ZA_1_005',2009,'country','ZA',2011,108.7,'KwaZulu-Natal'),
('level2','ZA_2_00418',2009,'level1','ZA_1_004',2011,19.4,'Lejweleputswa'),
('level1','ZA_1_009',2009,'country','ZA',2011,43,'Limpopo'),
('level2','ZA_2_00494',2009,'level1','ZA_1_004',2011,123.4,'Mangaung'),
('level2','ZA_2_00933',2009,'level1','ZA_1_009',2011,54.1,'Mopani'),
('level1','ZA_1_008',2009,'country','ZA',2011,52.8,'Mpumalanga'),
('level2','ZA_2_00306',2009,'level1','ZA_1_003',2011,0.9,'Namakwa'),
('level2','ZA_2_00293',2009,'level1','ZA_1_002',2011,588.1,'Nelson Mandela Bay'),
('level2','ZA_2_00638',2009,'level1','ZA_1_006',2011,29.6,'Ngaka Modiri Molema'),
('level2','ZA_2_00831',2009,'level1','ZA_1_008',2011,77.4,'Nkangala'),
('level1','ZA_1_006',2009,'country','ZA',2011,33.4,'North West'),
('level1','ZA_1_003',2009,'country','ZA',2011,3,'Northern Cape'),
('level2','ZA_2_00215',2009,'level1','ZA_1_002',2011,112.2,'O.R.Tambo'),
('level2','ZA_2_00103',2009,'level1','ZA_1_001',2011,21,'Overberg'),
('level2','ZA_2_00307',2009,'level1','ZA_1_003',2011,35.7,'Pixley ka Seme'),
('level2','ZA_2_00210',2009,'level1','ZA_1_002',2011,7.7,'Sarah Baartman'),
('level2','ZA_2_00742',2009,'level1','ZA_1_007',2011,217.9,'Sedibeng'),
('level2','ZA_2_00947',2009,'level1','ZA_1_009',2011,78.9,'Sekhukhune'),
('level2','ZA_2_00543',2009,'level1','ZA_1_005',2011,44,'Harry Gwala'),
('country','ZA',2009,'continent','AFR',2011,42.1,'South Africa'),
('level2','ZA_2_00419',2009,'level1','ZA_1_004',2011,21.9,'Thabo Mofutsanyane'),
('level2','ZA_2_00521',2009,'level1','ZA_1_005',2011,135.6,'Ugu'),
('level2','ZA_2_00522',2009,'level1','ZA_1_005',2011,105.2,'Umgungundlovu'),
('level2','ZA_2_00527',2009,'level1','ZA_1_005',2011,44.8,'Umkhanyakude'),
('level2','ZA_2_00524',2009,'level1','ZA_1_005',2011,59.4,'Umzinyathi'),
('level2','ZA_2_00523',2009,'level1','ZA_1_005',2011,58.6,'Uthukela'),
('level2','ZA_2_00528',2009,'level1','ZA_1_005',2011,109.7,'King Cetshwayo'),
('level2','ZA_2_00934',2009,'level1','ZA_1_009',2011,50.1,'Vhembe'),
('level2','ZA_2_00936',2009,'level1','ZA_1_009',2011,15,'Waterberg'),
('level2','ZA_2_00101',2009,'level1','ZA_1_001',2011,12.5,'West Coast'),
('level2','ZA_2_00748',2009,'level1','ZA_1_007',2011,199.2,'West Rand'),
('level1','ZA_1_001',2009,'country','ZA',2011,44.3,'Western Cape'),
('level2','ZA_2_00416',2009,'level1','ZA_1_004',2011,3.2,'Xhariep'),
('level2','ZA_2_00308',2009,'level1','ZA_1_003',2011,2.3,'Z F Mgcawu'),
('level2','ZA_2_00526',2009,'level1','ZA_1_005',2011,53.9,'Zululand'),
('level2','ZA_2_00244',2009,'level1','ZA_1_002',2016,80.4,'Alfred Nzo'),
('level2','ZA_2_00525',2009,'level1','ZA_1_005',2016,76.3,'Amajuba'),
('level2','ZA_2_00212',2009,'level1','ZA_1_002',2016,40.6,'Amathole'),
('level2','ZA_2_00637',2009,'level1','ZA_1_006',2016,89.6,'Bojanala'),
('level2','ZA_2_00292',2009,'level1','ZA_1_002',2016,329.3,'Buffalo City'),
('level2','ZA_2_00102',2009,'level1','ZA_1_001',2016,40.1,'Cape Winelands'),
('level2','ZA_2_00935',2009,'level1','ZA_1_009',2016,60.7,'Capricorn'),
('level2','ZA_2_00105',2009,'level1','ZA_1_001',2016,1.9,'Central Karoo'),
('level2','ZA_2_00213',2009,'level1','ZA_1_002',2016,23.1,'Chris Hani'),
('level2','ZA_2_00191',2009,'level1','ZA_1_001',2016,1641.5,'City of Cape Town'),
('level2','ZA_2_00798',2009,'level1','ZA_1_007',2016,3008.8,'City of Johannesburg'),
('level2','ZA_2_00799',2009,'level1','ZA_1_007',2016,520,'City of Tshwane'),
('level2','ZA_2_00640',2009,'level1','ZA_1_006',2016,50.3,'Dr Kenneth Kaunda'),
('level2','ZA_2_00639',2009,'level1','ZA_1_006',2016,10.4,'Dr Ruth Segomotsi Mompati'),
('level1','ZA_1_002',2009,'country','ZA',2016,41.3,'Eastern Cape'),
('level2','ZA_2_00104',2009,'level1','ZA_1_001',2016,26.1,'Garden Route'),
('level2','ZA_2_00832',2009,'level1','ZA_1_008',2016,62.4,'Ehlanzeni'),
('level2','ZA_2_00797',2009,'level1','ZA_1_007',2016,1710.7,'Ekurhuleni'),
('level2','ZA_2_00595',2009,'level1','ZA_1_005',2016,1615.8,'eThekwini'),
('level2','ZA_2_00420',2009,'level1','ZA_1_004',2016,23.8,'Fezile Dabi'),
('level2','ZA_2_00309',2009,'level1','ZA_1_003',2016,30,'Frances Baard'),
('level1','ZA_1_004',2009,'country','ZA',2016,21.8,'Free State'),
('level1','ZA_1_007',2009,'country','ZA',2016,737,'Gauteng'),
('level2','ZA_2_00830',2009,'level1','ZA_1_008',2016,35.4,'Gert Sibande'),
('level2','ZA_2_00529',2009,'level1','ZA_1_005',2016,199.7,'iLembe'),
('level2','ZA_2_00214',2009,'level1','ZA_1_002',2016,14.4,'Joe Gqabi'),
('level2','ZA_2_00345',2009,'level1','ZA_1_003',2016,8.8,'John Taolo Gaetsewe'),
('level1','ZA_1_005',2009,'country','ZA',2016,117.2,'KwaZulu-Natal'),
('level2','ZA_2_00418',2009,'level1','ZA_1_004',2016,20.1,'Lejweleputswa'),
('level1','ZA_1_009',2009,'country','ZA',2016,46.1,'Limpopo'),
('level2','ZA_2_00494',2009,'level1','ZA_1_004',2016,125.4,'Mangaung'),
('level2','ZA_2_00933',2009,'level1','ZA_1_009',2016,57.4,'Mopani'),
('level1','ZA_1_008',2009,'country','ZA',2016,56.6,'Mpumalanga'),
('level2','ZA_2_00306',2009,'level1','ZA_1_003',2016,0.9,'Namakwa'),
('level2','ZA_2_00293',2009,'level1','ZA_1_002',2016,644.8,'Nelson Mandela Bay'),
('level2','ZA_2_00638',2009,'level1','ZA_1_006',2016,31.3,'Ngaka Modiri Molema'),
('level2','ZA_2_00831',2009,'level1','ZA_1_008',2016,85.5,'Nkangala'),
('level1','ZA_1_006',2009,'country','ZA',2016,35.6,'North West'),
('level1','ZA_1_003',2009,'country','ZA',2016,3.2,'Northern Cape'),
('level2','ZA_2_00215',2009,'level1','ZA_1_002',2016,119.8,'O.R.Tambo'),
('level2','ZA_2_00103',2009,'level1','ZA_1_001',2016,23.3,'Overberg'),
('level2','ZA_2_00307',2009,'level1','ZA_1_003',2016,37.4,'Pixley ka Seme'),
('level2','ZA_2_00210',2009,'level1','ZA_1_002',2016,8.2,'Sarah Baartman'),
('level2','ZA_2_00742',2009,'level1','ZA_1_007',2016,227.6,'Sedibeng'),
('level2','ZA_2_00947',2009,'level1','ZA_1_009',2016,85.7,'Sekhukhune'),
('level2','ZA_2_00543',2009,'level1','ZA_1_005',2016,48.1,'Harry Gwala'),
('country','ZA',2009,'continent','AFR',2016,45.3,'South Africa'),
('level2','ZA_2_00419',2009,'level1','ZA_1_004',2016,23.3,'Thabo Mofutsanyane'),
('level2','ZA_2_00521',2009,'level1','ZA_1_005',2016,148.3,'Ugu'),
('level2','ZA_2_00522',2009,'level1','ZA_1_005',2016,114.4,'Umgungundlovu'),
('level2','ZA_2_00527',2009,'level1','ZA_1_005',2016,49.4,'Umkhanyakude'),
('level2','ZA_2_00524',2009,'level1','ZA_1_005',2016,64.1,'Umzinyathi'),
('level2','ZA_2_00523',2009,'level1','ZA_1_005',2016,61.9,'Uthukela'),
('level2','ZA_2_00528',2009,'level1','ZA_1_005',2016,117.4,'King Cetshwayo'),
('level2','ZA_2_00934',2009,'level1','ZA_1_009',2016,53.9,'Vhembe'),
('level2','ZA_2_00936',2009,'level1','ZA_1_009',2016,16.5,'Waterberg'),
('level2','ZA_2_00101',2009,'level1','ZA_1_001',2016,13.9,'West Coast'),
('level2','ZA_2_00748',2009,'level1','ZA_1_007',2016,203.5,'West Rand'),
('level1','ZA_1_001',2009,'country','ZA',2016,47.7,'Western Cape'),
('level2','ZA_2_00416',2009,'level1','ZA_1_004',2016,3.3,'Xhariep'),
('level2','ZA_2_00308',2009,'level1','ZA_1_003',2016,2.5,'Z F Mgcawu'),
('level2','ZA_2_00526',2009,'level1','ZA_1_005',2016,59.8,'Zululand') ON CONFLICT DO NOTHING;
      
INSERT INTO public.sources(geo_level, country_code, table_name, source_title, source_link) VALUES('level1','ZA','allPopulationDensities','"Census, 2011 and Community Survey, 2016"','https://open.africa/dataset/south-africa-population-land-area-and-population-density') ON CONFLICT DO NOTHING;
INSERT INTO public.sources(geo_level, country_code, table_name, source_title, source_link) VALUES('country','ZA','allPopulationDensities','"Census, 2011 and Community Survey, 2016"','https://open.africa/dataset/south-africa-population-land-area-and-population-density') ON CONFLICT DO NOTHING;
