SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET client_min_messages = warning;

ALTER TABLE IF EXISTS ONLY public.means_of_transport DROP CONSTRAINT IF EXISTS pk_means_of_transport;
DROP TABLE IF EXISTS public.means_of_transport;
SET default_tablespace = '';

SET default_with_oids = false;

CREATE TABLE IF NOT EXISTS public.means_of_transport (
	geo_level TEXT,
	geo_code TEXT,
	geo_version NUMERIC,
	parent_level TEXT,
	parent_code TEXT,
	variable TEXT,
	value NUMERIC,
	name TEXT
);

INSERT INTO public.means_of_transport VALUES
('level1','ZA_1_002',2009,'country','ZA','Unspecified',80714.26381,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',109120.5378,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Bus',27714.59306,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Own car or other private vehicle',106567.7597,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Bicycle/motorcycle',15731.13633,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Not applicable',4369811.217,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Other',0,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Vehicle hired by a group of parents',213662.8452,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',96316.74065,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Walking',1484833.603,'Eastern Cape'),
('level1','ZA_1_002',2009,'country','ZA','Train',3664.831967,'Eastern Cape'),
('level1','ZA_1_004',2009,'country','ZA','Vehicle hired by a group of parents',36889.84823,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Bus',13086.79077,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Not applicable',1996466.262,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Unspecified',33700.47456,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Other',1193.06502,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Own car or other private vehicle',82521.49708,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Bicycle/motorcycle',14103.76353,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',63482.90718,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',13328.87013,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Walking',634702.6444,'Free State'),
('level1','ZA_1_004',2009,'country','ZA','Train',1771.956644,'Free State'),
('level1','ZA_1_007',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',301196.3906,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Not applicable',11038641.14,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',105696.0182,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Bicycle/motorcycle',30160.02992,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Bus',147064.4713,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Unspecified',310425.2637,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Own car or other private vehicle',520186.1973,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Walking',1610255.796,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Other',21092.55844,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Vehicle hired by a group of parents',550743.9405,'Gauteng'),
('level1','ZA_1_007',2009,'country','ZA','Train',25282.69087,'Gauteng'),
('level1','ZA_1_005',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',58985.2141,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Own car or other private vehicle',206440.087,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Other',4762.913215,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Vehicle hired by a group of parents',438032.5682,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Not applicable',7727455.333,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Train',8067.493577,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',218361.9743,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Walking',2313828.52,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Unspecified',107208.3226,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Bus',105399.9049,'KwaZulu-Natal'),
('level1','ZA_1_005',2009,'country','ZA','Bicycle/motorcycle',26675.26224,'KwaZulu-Natal'),
('level1','ZA_1_009',2009,'country','ZA','Bus',49219.91239,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Unspecified',80328.98576,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',140346.5427,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Vehicle hired by a group of parents',178572.1786,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Bicycle/motorcycle',13676.12351,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Other',2687.676707,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Train',0,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Own car or other private vehicle',49268.55701,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Walking',1495911.816,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',25781.80496,'Limpopo'),
('level1','ZA_1_009',2009,'country','ZA','Not applicable',3817962.493,'Limpopo'),
('level1','ZA_1_008',2009,'country','ZA','Bicycle/motorcycle',7733.787315,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Unspecified',50608.6779,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Own car or other private vehicle',52101.97001,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Vehicle hired by a group of parents',117692.2052,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Walking',964429.6295,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Bus',56911.28677,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Not applicable',3168025.259,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',52708.29418,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',50879.85108,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Train',503.1478578,'Mpumalanga'),
('level1','ZA_1_008',2009,'country','ZA','Other',1839.374248,'Mpumalanga'),
('level1','ZA_1_006',2009,'country','ZA','Train',853.3691813,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Bus',46080.60882,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Own car or other private vehicle',70667.31592,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Not applicable',2801835.099,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Bicycle/motorcycle',8386.429309,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',73735.86558,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Other',571.4801915,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',22306.11979,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Unspecified',42981.97573,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Vehicle hired by a group of parents',112241.6938,'North West'),
('level1','ZA_1_006',2009,'country','ZA','Walking',745558.3801,'North West'),
('level1','ZA_1_003',2009,'country','ZA','Other',204.0487088,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Walking',220782.6489,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Train',0,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Bicycle/motorcycle',2225.438697,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Bus',10396.78305,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Own car or other private vehicle',30816.71378,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Unspecified',4478.954661,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',20020.82221,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Vehicle hired by a group of parents',20770.29827,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Not applicable',898981.0681,'Northern Cape'),
('level1','ZA_1_003',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',21117.62212,'Northern Cape'),
('country','ZA',2009,'continent','AFR','Not applicable',40927437.38,'South Africa'),
('country','ZA',2009,'continent','AFR','Unspecified',760725.7203,'South Africa'),
('country','ZA',2009,'continent','AFR','Walking',10185408.38,'South Africa'),
('country','ZA',2009,'continent','AFR','Own car or other private vehicle',1421026.291,'South Africa'),
('country','ZA',2009,'continent','AFR','Vehicle hired by a group of parents',1828380.81,'South Africa'),
('country','ZA',2009,'continent','AFR','Bicycle/motorcycle',132814.3271,'South Africa'),
('country','ZA',2009,'continent','AFR','Minibus/bus provided by institution/government and not paid for',462315.0721,'South Africa'),
('country','ZA',2009,'continent','AFR','Train',55395.64659,'South Africa'),
('country','ZA',2009,'continent','AFR','Other',34230.94652,'South Africa'),
('country','ZA',2009,'continent','AFR','Minibus taxi/sedan taxi/bakkie taxi',1078678.745,'South Africa'),
('country','ZA',2009,'continent','AFR','Bus',571397.6926,'South Africa'),
('level1','ZA_1_001',2009,'country','ZA','Not applicable',5108259.51,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Bicycle/motorcycle',14122.3563,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Minibus taxi/sedan taxi/bakkie taxi',100437.0538,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Train',15252.15649,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Unspecified',50278.80155,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Minibus/bus provided by institution/government and not paid for',67171.18787,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Vehicle hired by a group of parents',159775.2321,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Own car or other private vehicle',302456.1932,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Other',1879.829988,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Bus',115523.3415,'Western Cape'),
('level1','ZA_1_001',2009,'country','ZA','Walking',715105.3434,'Western Cape');
      
INSERT into public.sources(geo_level, country_code, table_name, source_title, source_link) VALUES('level1','ZA','allMeansOfTransports','"General Household Survey, 2018"','https://open.africa/dataset/general-household-survey-2018/resource/f2853276-1066-49e7-979b-f1175f9b1531') on conflict do nothing;
INSERT into public.sources(geo_level, country_code, table_name, source_title, source_link) VALUES('country','ZA','allMeansOfTransports','"General Household Survey, 2018"','https://open.africa/dataset/general-household-survey-2018/resource/f2853276-1066-49e7-979b-f1175f9b1531') on conflict do nothing;

ALTER TABLE ONLY public.means_of_transport ADD CONSTRAINT pk_means_of_transport PRIMARY KEY (geo_level, geo_code, geo_version, parent_level, parent_code, variable, value, name);
